# Practical Work & Assignments - Kubernetes Ingress (Ubuntu 22.04)

âœ… Step 1: Server Update & Prerequisites
sudo apt update && sudo apt upgrade -y
sudo apt install -y ca-certificates curl gnupg lsb-release
ðŸ§¾ Roman Urdu: System update aur curl/ca-certificates install kar rahe hain jo Docker aur Kubernetes ke liye required hain.

âœ… Step 2: Docker Install
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu jammy stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin
sudo systemctl enable docker
sudo systemctl start docker
sudo docker --version
ðŸ§¾ Roman Urdu: Docker install kiya jaye jo Kubernetes containers run karega.

âœ… Step 3: Add Kubernetes Repo
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
echo "deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.30/deb/ /" | sudo tee /etc/apt/sources.list.d/kubernetes.list
sudo apt update
ðŸ§¾ Roman Urdu: Kubernetes ke official repo add kiya.

âœ… Step 4: Install Kubernetes Tools
sudo apt install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl
ðŸ§¾ Roman Urdu: Basic tools install kiye - kubelet, kubeadm, kubectl.

âœ… Step 5: Disable Swap
sudo swapoff -a
sudo sed -i '/ swap / s/^/#/' /etc/fstab
ðŸ§¾ Roman Urdu: Swap disable kiya kyunke Kubernetes swap support nahi karta.

âœ… Step 6: Kernel Modules & sysctl
sudo modprobe overlay
sudo modprobe br_netfilter
cat <<EOF | sudo tee /etc/modules-load.d/k8s.conf
overlay
br_netfilter
EOF
cat <<EOF | sudo tee /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
net.ipv4.ip_forward = 1
EOF
sudo sysctl --system
ðŸ§¾ Roman Urdu: Networking aur IP forwarding settings configure ki.

âœ… Step 7: Install & Configure containerd
sudo apt install -y containerd
sudo mkdir -p /etc/containerd
sudo containerd config default | sudo tee /etc/containerd/config.toml
sudo sed -i 's/SystemdCgroup = false/SystemdCgroup = true/' /etc/containerd/config.toml
sudo systemctl restart containerd
sudo systemctl enable containerd
ðŸ§¾ Roman Urdu: Containerd configure kiya aur systemd cgroup enable kiya.

âœ… Step 8: Initialize Kubernetes Cluster
sudo kubeadm init --pod-network-cidr=192.168.0.0/16
ðŸ§¾ Roman Urdu: Cluster initialize kiya Calico CIDR ke sath.

âœ… Step 9: kubeconfig Setup
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
ðŸ§¾ Roman Urdu: Normal user ke liye kubectl config setup ki.

âœ… Step 10: Install Calico
kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml
ðŸ§¾ Roman Urdu: Calico install kiya pods ke beech networking ke liye.

âœ… Step 11: Verify Nodes & Pods
kubectl get nodes
kubectl get pods -n kube-system
ðŸ§¾ Roman Urdu: Check kiya sab pods running hain ya nahi.

âœ… Step 12: Install NGINX Ingress Controller
kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.9.1/deploy/static/provider/cloud/deploy.yaml
kubectl get pods -n ingress-nginx
ðŸ§¾ Roman Urdu: NGINX Ingress controller install kiya traffic route karne ke liye.

âœ… Step 13: Create Sample Deployments
kubectl create deployment frontend --image=nginx
kubectl expose deployment frontend --port=80 --name=frontend-svc
kubectl create deployment backend --image=nginx
kubectl expose deployment backend --port=80 --name=backend-svc
ðŸ§¾ Roman Urdu: Frontend aur backend ke simple apps deploy kiye.

âœ… Step 14: Create Ingress YAML
multiapp-ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: multiapp-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: frontend-svc
            port:
              number: 80
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: backend-svc
            port:
              number: 80
ðŸ§¾ Roman Urdu: YAML file define ki ke / frontend aur /api backend route ho.

âœ… Step 15: Apply Ingress Rule
kubectl apply -f multiapp-ingress.yaml
ðŸ§¾ Roman Urdu: Ingress rule apply ki.

âœ… Step 16: Test Ingress
kubectl get ingress
kubectl get svc
ðŸ§¾ Roman Urdu: Ingress ka external IP check karo aur browser se / aur /api test karo.

ðŸ“š Assignment: Practice Multiple App Routing
â€¢ Create 2 deployments: frontend, backend
â€¢ Expose both as services
â€¢ Create Ingress rule: / â†’ frontend, /api â†’ backend
ðŸ§¾  Sikho multiple services ko single IP par alag paths pe route karna using Ingress. Ye assignment completed hai.
