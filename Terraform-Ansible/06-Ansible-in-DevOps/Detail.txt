Ansible in DevOps (Detailed Notes)

Ansible is an open-source automation tool used for configuration management, application deployment, and task automation.
It allows IT teams to automate repetitive tasks such as software installation, system updates, and cloud resource management.

In DevOps, Ansible helps streamline the process of managing servers, ensuring consistency, and reducing errors.
It is agentless — meaning no special software needs to be installed on the managed machines.
Ansible uses human-readable **YAML playbooks** to define automation tasks.

---

## **Ansible Usage in DevOps**

* Deploying applications
* Configuring servers
* Automating updates and patches
* Managing cloud environments

---

## **Ansible Basics (Part 1)**

### **1. What is Configuration Management?**

**Concept:**
Configuration management is the practice of maintaining software and system configurations consistently across multiple servers.

**Importance in DevOps:**
Ansible automates repetitive tasks such as system updates, application installations, and configuration management, ensuring consistency and minimizing human error.

---

### **2. What is an Inventory File?**

**Concept:**
The inventory file lists the managed nodes or servers where Ansible performs tasks.
It includes IP addresses or hostnames of the target systems.

**Example (INI format):**

```
[webservers]
192.168.1.10
192.168.1.11

[dbservers]
192.168.1.12
```

**Importance:**
It defines target groups for automation and helps Ansible know where to apply configurations.

---

### **3. Installing Ansible and Creating Playbooks**

**Practical Work: Install Ansible and Create Playbooks**

**Step 1: Install Ansible**

* For Ubuntu:

  ```
  sudo apt update
  sudo apt install ansible
  ```
* For CentOS:

  ```
  sudo yum install ansible
  ```

**Step 2: Create Inventory File**

```
[webservers]
192.168.1.10
192.168.1.11
```

**Step 3: Write a Simple Playbook (install_nginx.yml)**

```yaml
---
- hosts: webservers
  become: yes
  tasks:
    - name: Install Nginx
      apt:
        name: nginx
        state: present
```

**Step 4: Run the Playbook**

```
ansible-playbook install_nginx.yml -i inventory.ini
```

**Result:**
This command executes the playbook tasks on all servers listed in the inventory file.

---

### **4. Assignment: Setup Simple Playbook and Run**

**Objective:**
Create a playbook to install Nginx on multiple servers using an inventory file.

**Steps:**

1. Create an inventory file (`inventory.ini`) listing the target servers.
2. Write the playbook (`install_nginx.yml`) to install Nginx.
3. Run the playbook using:

   ```
   ansible-playbook install_nginx.yml -i inventory.ini
   ```
4. Verify that Nginx is successfully installed and running.

**Summary:**
Covers the basics of Configuration Management, Inventory Files, and Playbooks.
Includes installation, file creation, and automated Nginx deployment.

---

## **Ansible Advanced (Part 2)**

### **1. What are Roles in Ansible?**

**Concept:**
Roles structure playbooks into reusable, modular units that group related tasks, variables, templates, and files.

**Role Structure:**

```
my_role/
├── tasks/
├── vars/
├── templates/
├── files/
├── defaults/
└── meta/
```

**Importance:**
Encourages modularization, reusability, and cleaner project organization.

---

### **2. What are Variables in Ansible?**

**Concept:**
Variables define reusable values for tasks, roles, or playbooks.

**Example:**
In Playbook:

```yaml
vars:
  package_name: "nginx"
```

In Variable File (`vars/main.yml`):

```yaml
nginx_version: "1.18"
```

**Importance:**
Makes playbooks dynamic and easy to maintain without repetitive hardcoding.

---

### **3. What are Templates in Ansible?**

**Concept:**
Templates are dynamic files that replace variables at runtime using the **Jinja2 engine**.

**Example (nginx.conf.j2):**

```
server {
  listen 80;
  server_name {{ server_name }};
  root {{ root_directory }};
}
```

**Importance:**
Enables automated configuration file generation with variable-based customization.

---

### **4. Practical Work: Create a Role-Based Project**

**Steps:**

1. **Create Role Directory Structure:**

   ```
   ansible-galaxy init my_role
   ```

   Structure created:

   ```
   my_role/
   ├── defaults/
   ├── files/
   ├── handlers/
   ├── meta/
   ├── tasks/
   ├── templates/
   └── vars/
   ```

2. **Define Tasks in `tasks/main.yml`:**

   ```yaml
   ---
   - name: Install Nginx
     apt:
       name: nginx
       state: present
   ```

3. **Define Variables in `vars/main.yml`:**

   ```
   nginx_version: "1.18"
   ```

4. **Use Templates in `templates/nginx.conf.j2`:**
   Create a Jinja2 configuration file template.

5. **Apply Role in Playbook (`site.yml`):**

   ```yaml
   ---
   - hosts: webservers
     roles:
       - my_role
   ```

6. **Run the Playbook:**

   ```
   ansible-playbook -i inventory site.yml
   ```

---

### **5. Assignment: Deploy an App Using Ansible Role**

**Objective:**
Deploy a simple web application (Nginx + custom HTML) using an Ansible role.

**Steps:**

1. Create a role for web app deployment.
2. Define tasks to install Nginx.
3. Create an HTML template file (`index.html.j2`).
4. Define variables in `vars/main.yml`:

   ```
   app_name: "my_website"
   html_content: "<h1>Welcome to {{ app_name }}!</h1>"
   ```
5. Write a playbook (`deploy_app.yml`):

   ```yaml
   ---
   - hosts: webservers
     roles:
       - web_app_role
   ```
6. Run the playbook:

   ```
   ansible-playbook -i inventory deploy_app.yml
   ```

---

### **Summary of Ansible Advanced Part 2**

* Roles organize tasks, variables, and templates into reusable structures.
* Variables make playbooks dynamic and adaptable.
* Templates generate configuration files dynamically.
* Practical: Created a role-based project to deploy Nginx and custom websites.
* Assignment: Built and deployed a simple HTML web app using an Ansible role.

